<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>axios取消请求</title>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body>
<button id="btn1">点我获取所有人的信息</button>
<script type="text/javascript">
    // const btn1 =document.getElementById("btn1");
    //
    // axios.interceptors.request.use((config)=>{
    //     if(Date.now()%2 === 0){
    //         config.headers.school = '111'
    //     }
    //     return config
    // })
    // axios.interceptors.response.use(response=>{
    //         console.log(response);
    //         if(Date.now() % 2 === 0){
    //             return response.data
    //         }else {
    //             return '数据错误'
    //         }
    //     },
    //     error=>{
    //         console.log(error);
    //         return new Promise(()=>{})
    //     })
    // btn1.onclick =()=>{
    //     axios({
    //         url:"http://localhost:3000/students",
    //         method: "GET",
    //     }).then(
    //         response=>{console.log(response)},
    //         error=>{console.log(error) }
    //     )
    // }
    const btn1 = document.getElementById('btn1')
    axios.interceptors.request.use((config)=>{
        // config.a = 1
        if(Date.now()%2 === 0){
            config.headers.token = 'one'
        }
        console.log(config);
        return config
    })
    btn1.onclick =()=>{
        axios({
            url:'http://localhost:5000/persons',
            method:'GET',
            // params:{id:1}
        }).then(
            response=>{
                console.log(response);},
            reason =>{
                console.log(reason);
            }
        )
    }

</script>
</body>
</html>